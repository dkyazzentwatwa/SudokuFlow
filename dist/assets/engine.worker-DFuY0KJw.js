var V=Object.defineProperty;var J=(t,e,s)=>e in t?V(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var _=(t,e,s)=>J(t,typeof e!="symbol"?e+"":e,s);function w(t,e){return t*9+e}function C(t){return[Math.floor(t/9),t%9]}function K(t,e){return Math.floor(t/3)*3+Math.floor(e/3)}function T(t){const[e,s]=C(t);return K(e,s)}Array.from({length:9},(t,e)=>e);Array.from({length:9},(t,e)=>e+9);Array.from({length:9},(t,e)=>e+18);function S(t){return t<9?"row":t<18?"col":"box"}function m(t){const e=S(t),s=[];if(e==="row"){const i=t;for(let n=0;n<9;n++)s.push(w(i,n))}else if(e==="col"){const i=t-9;for(let n=0;n<9;n++)s.push(w(n,i))}else{const i=t-18,n=Math.floor(i/3)*3,o=i%3*3;for(let a=0;a<3;a++)for(let l=0;l<3;l++)s.push(w(n+a,o+l))}return s}const B=511;function W(t){return 1<<t-1}function h(t,e){return(t&W(e))!==0}function L(t,e){return t&~W(e)}function X(t){return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}function*ee(t){for(let e=1;e<=9;e++)h(t,e)&&(yield e)}function te(t){return Array.from(ee(t))}function ne(t){if(t===0)return 0;let e=1,s=1;for(;!(t&s);)s<<=1,e++;return e}function ie(t,e){return t|e}function A(t){return t!==0&&(t&t-1)===0}function q(t){return A(t)?ne(t):0}let x=null;function z(t){return x||se(),x[t]}function se(){x=new Array(81);for(let t=0;t<81;t++){const e=new Set,[s,i]=C(t),n=T(t);for(let l=0;l<9;l++)l!==i&&e.add(w(s,l));for(let l=0;l<9;l++)l!==s&&e.add(w(l,i));const o=Math.floor(n/3)*3,a=n%3*3;for(let l=0;l<3;l++)for(let r=0;r<3;r++){const f=w(o+l,a+r);f!==t&&e.add(f)}x[t]=Array.from(e)}}function O(){const t=new Array(81);for(let e=0;e<81;e++)t[e]={given:!1,value:0,candidates:B};return t}function y(t){return t.map(e=>({given:e.given,value:e.value,candidates:e.candidates}))}function H(t){const e=t.replace(/[\s\n]/g,"");if(e.length!==81)return null;const s=O();for(let i=0;i<81;i++){const n=e[i];if(n!=="0"&&n!=="."){const o=parseInt(n,10);o>=1&&o<=9&&(s[i].given=!0,s[i].value=o,s[i].candidates=0)}}return v(s),s}function v(t){for(let e=0;e<81;e++)if(t[e].value===0){t[e].candidates=B;const s=z(e);for(const i of s)t[i].value!==0&&(t[e].candidates=L(t[e].candidates,t[i].value))}else t[e].candidates=0}function N(t,e){const s=t[e.cell];if(e.type==="place"){if(s.value!==0||!h(s.candidates,e.digit))return!1;s.value=e.digit,s.candidates=0;const i=z(e.cell);for(const n of i)t[n].value===0&&(t[n].candidates=L(t[n].candidates,e.digit));return!0}else return s.value!==0||!h(s.candidates,e.digit)?!1:(s.candidates=L(s.candidates,e.digit),!0)}function Z(t,e){for(const s of e)if(!N(t,s))return!1;return!0}function oe(t){for(let e=0;e<27;e++){const s=m(e),i=new Set;for(const n of s){const o=t[n].value;if(o!==0){if(i.has(o))return!1;i.add(o)}}}for(let e=0;e<81;e++)if(t[e].value===0&&t[e].candidates===0)return!1;return!0}function D(t){for(let e=0;e<81;e++)if(t[e].value===0)return!1;return oe(t)}function k(t,e,s){const i=m(e),n=[];for(const o of i)t[o].value===0&&h(t[o].candidates,s)&&n.push(o);return n}function le(t){for(let e=0;e<81;e++)if(t[e].value===0&&A(t[e].candidates)){const s=q(t[e].candidates),[i,n]=C(e);return{kind:"NakedSingle",label:`Naked Single: ${s}`,rationale:`Cell R${i+1}C${n+1} has only one candidate: ${s}`,affectedCells:[e],eliminations:[],placements:[{type:"place",cell:e,digit:s}],candidateSnapshots:new Map([[e,t[e].candidates]])}}return null}function ae(t){for(let e=0;e<27;e++){const s=S(e);for(let i=1;i<=9;i++){const n=k(t,e,i);if(n.length===1){const o=n[0];if(t[o].value===0){const[a,l]=C(o);let r="";return s==="row"?r=`row ${e+1}`:s==="col"?r=`column ${e-9+1}`:r=`box ${e-18+1}`,{kind:"HiddenSingle",label:`Hidden Single: ${i} in ${r}`,rationale:`Digit ${i} can only go in R${a+1}C${l+1} within ${r}`,affectedCells:[o],eliminations:[],placements:[{type:"place",cell:o,digit:i}],houses:[e],candidateSnapshots:new Map([[o,t[o].candidates]])}}}}}return null}function re(t){for(let e=0;e<27;e++){const s=S(e),i=m(e),n=[],o=new Set([1,2,3,4,5,6,7,8,9]);for(const a of i)t[a].value===0?n.push(a):o.delete(t[a].value);if(n.length===1&&o.size===1){const a=n[0],l=Array.from(o)[0],[r,f]=C(a);let c="";return s==="row"?c=`row ${e+1}`:s==="col"?c=`column ${e-9+1}`:c=`box ${e-18+1}`,{kind:"LastDigit",label:`Last Digit: ${l} in ${c}`,rationale:`R${r+1}C${f+1} is the last empty cell in ${c}, must be ${l}`,affectedCells:[a],eliminations:[],placements:[{type:"place",cell:a,digit:l}],houses:[e],candidateSnapshots:new Map([[a,t[a].candidates]])}}}return null}function P(t,e){for(let s=0;s<27;s++){const i=m(s),n=[];for(const a of i)t[a].value===0&&n.push({cell:a,candidates:t[a].candidates});if(n.length<=e)continue;const o=ce(t,n,e,s);if(o)return o}return null}function ce(t,e,s,i){const n=F(e,s);for(const o of n){let a=0;for(const l of o)a=ie(a,l.candidates);if(X(a)===s){const l=[],r=o.map(c=>c.cell),f=te(a);for(const{cell:c,candidates:u}of e)if(!r.includes(c))for(const d of f)h(u,d)&&l.push({type:"eliminate",cell:c,digit:d});if(l.length>0){const c=S(i);let u="";c==="row"?u=`row ${i+1}`:c==="col"?u=`column ${i-9+1}`:u=`box ${i-18+1}`;const d=["","","Pair","Triple","Quad"][s],p=r.map(g=>{const[M,b]=C(g);return`R${M+1}C${b+1}`}).join(", ");return{kind:`Naked${d}`,label:`Naked ${d} in ${u}`,rationale:`Cells ${p} contain only digits {${f.join(",")}}`,affectedCells:[...r,...l.map(g=>g.cell)],eliminations:l,placements:[],houses:[i],candidateSnapshots:new Map([...r,...l.map(g=>g.cell)].map(g=>[g,t[g].candidates]))}}}}return null}function E(t,e){for(let s=0;s<27;s++){const i=m(s),n=new Map;for(let a=1;a<=9;a++){const l=[];for(const r of i)t[r].value===0&&h(t[r].candidates,a)&&l.push(r);l.length>0&&l.length<=e&&n.set(a,l)}const o=ue(t,n,e,s);if(o)return o}return null}function ue(t,e,s,i){const n=Array.from(e.keys()),o=F(n,s);for(const a of o){const l=new Set;for(const r of a){const f=e.get(r);for(const c of f)l.add(c)}if(l.size===s){const r=[],f=Array.from(l);for(const c of f)for(let u=1;u<=9;u++)!a.includes(u)&&h(t[c].candidates,u)&&r.push({type:"eliminate",cell:c,digit:u});if(r.length>0){const c=S(i);let u="";c==="row"?u=`row ${i+1}`:c==="col"?u=`column ${i-9+1}`:u=`box ${i-18+1}`;const d=["","","Pair","Triple","Quad"][s],p=f.map(g=>{const[M,b]=C(g);return`R${M+1}C${b+1}`}).join(", ");return{kind:`Hidden${d}`,label:`Hidden ${d} in ${u}`,rationale:`Digits {${a.join(",")}} can only go in cells ${p} within ${u}`,affectedCells:f,eliminations:r,placements:[],houses:[i],candidateSnapshots:new Map(f.map(g=>[g,t[g].candidates]))}}}}return null}function F(t,e){if(e===0)return[[]];if(t.length<e)return[];const s=[];function i(n,o){if(o.length===e){s.push([...o]);return}for(let a=n;a<t.length;a++)o.push(t[a]),i(a+1,o),o.pop()}return i(0,[]),s}function fe(t){for(let e=0;e<9;e++){const s=e+18,i=m(s);for(let n=1;n<=9;n++){const o=[];for(const a of i)t[a].value===0&&h(t[a].candidates,n)&&o.push(a);if(o.length===2||o.length===3){const a=o.map(c=>Math.floor(c/9)),l=o.map(c=>c%9),r=a.every(c=>c===a[0]),f=l.every(c=>c===l[0]);if(r){const c=a[0],u=[];for(let d=0;d<9;d++){const p=c*9+d;!o.includes(p)&&t[p].value===0&&h(t[p].candidates,n)&&u.push({type:"eliminate",cell:p,digit:n})}if(u.length>0)return{kind:"PointingPair",label:`Pointing ${o.length===2?"Pair":"Triple"}: ${n}`,rationale:`Digit ${n} in box ${e+1} must be in row ${c+1}`,affectedCells:[...o,...u.map(d=>d.cell)],eliminations:u,placements:[],houses:[s,c],candidateSnapshots:new Map(u.map(d=>[d.cell,t[d.cell].candidates]))}}if(f){const c=l[0],u=[];for(let d=0;d<9;d++){const p=d*9+c;!o.includes(p)&&t[p].value===0&&h(t[p].candidates,n)&&u.push({type:"eliminate",cell:p,digit:n})}if(u.length>0)return{kind:"PointingPair",label:`Pointing ${o.length===2?"Pair":"Triple"}: ${n}`,rationale:`Digit ${n} in box ${e+1} must be in column ${c+1}`,affectedCells:[...o,...u.map(d=>d.cell)],eliminations:u,placements:[],houses:[s,c+9],candidateSnapshots:new Map(u.map(d=>[d.cell,t[d.cell].candidates]))}}}}}return null}function de(t){for(let e=0;e<9;e++){const s=m(e);for(let i=1;i<=9;i++){const n=[];for(const o of s)t[o].value===0&&h(t[o].candidates,i)&&n.push(o);if(n.length===2||n.length===3){const o=n.map(l=>T(l));if(o.every(l=>l===o[0])){const l=o[0],r=l+18,f=m(r),c=[];for(const u of f)!n.includes(u)&&t[u].value===0&&h(t[u].candidates,i)&&c.push({type:"eliminate",cell:u,digit:i});if(c.length>0)return{kind:"ClaimingPair",label:`Claiming ${n.length===2?"Pair":"Triple"}: ${i}`,rationale:`Digit ${i} in row ${e+1} must be in box ${l+1}`,affectedCells:[...n,...c.map(u=>u.cell)],eliminations:c,placements:[],houses:[e,r],candidateSnapshots:new Map(c.map(u=>[u.cell,t[u.cell].candidates]))}}}}}for(let e=0;e<9;e++){const s=m(e+9);for(let i=1;i<=9;i++){const n=[];for(const o of s)t[o].value===0&&h(t[o].candidates,i)&&n.push(o);if(n.length===2||n.length===3){const o=n.map(l=>T(l));if(o.every(l=>l===o[0])){const l=o[0],r=l+18,f=m(r),c=[];for(const u of f)!n.includes(u)&&t[u].value===0&&h(t[u].candidates,i)&&c.push({type:"eliminate",cell:u,digit:i});if(c.length>0)return{kind:"ClaimingPair",label:`Claiming ${n.length===2?"Pair":"Triple"}: ${i}`,rationale:`Digit ${i} in column ${e+1} must be in box ${l+1}`,affectedCells:[...n,...c.map(u=>u.cell)],eliminations:c,placements:[],houses:[e+9,r],candidateSnapshots:new Map(c.map(u=>[u.cell,t[u.cell].candidates]))}}}}}return null}function pe(t){for(let e=1;e<=9;e++){const s=ge(t,e);if(s)return s;const i=he(t,e);if(i)return i}return null}function ge(t,e){const s=new Map;for(let n=0;n<9;n++){const o=k(t,n,e);if(o.length===2){const a=o.map(l=>l%9);s.set(n,a)}}const i=Array.from(s.keys());for(let n=0;n<i.length;n++)for(let o=n+1;o<i.length;o++){const a=i[n],l=i[o],r=s.get(a),f=s.get(l);if(r[0]===f[0]&&r[1]===f[1]){const c=[],u=[a*9+r[0],a*9+r[1],l*9+r[0],l*9+r[1]];for(let d=0;d<9;d++)if(d!==a&&d!==l)for(const p of r){const g=d*9+p;t[g].value===0&&h(t[g].candidates,e)&&c.push({type:"eliminate",cell:g,digit:e})}if(c.length>0)return{kind:"XWing",label:`X-Wing: ${e} in rows ${a+1},${l+1}`,rationale:`Digit ${e} forms X-Wing pattern in rows ${a+1} and ${l+1} on columns ${r[0]+1} and ${r[1]+1}`,affectedCells:[...u,...c.map(d=>d.cell)],eliminations:c,placements:[],houses:[a,l,r[0]+9,r[1]+9],candidateSnapshots:new Map(c.map(d=>[d.cell,t[d.cell].candidates]))}}}return null}function he(t,e){const s=new Map;for(let n=0;n<9;n++){const o=k(t,n+9,e);if(o.length===2){const a=o.map(l=>Math.floor(l/9));s.set(n,a)}}const i=Array.from(s.keys());for(let n=0;n<i.length;n++)for(let o=n+1;o<i.length;o++){const a=i[n],l=i[o],r=s.get(a),f=s.get(l);if(r[0]===f[0]&&r[1]===f[1]){const c=[],u=[r[0]*9+a,r[1]*9+a,r[0]*9+l,r[1]*9+l];for(let d=0;d<9;d++)if(d!==a&&d!==l)for(const p of r){const g=p*9+d;t[g].value===0&&h(t[g].candidates,e)&&c.push({type:"eliminate",cell:g,digit:e})}if(c.length>0)return{kind:"XWing",label:`X-Wing: ${e} in columns ${a+1},${l+1}`,rationale:`Digit ${e} forms X-Wing pattern in columns ${a+1} and ${l+1} on rows ${r[0]+1} and ${r[1]+1}`,affectedCells:[...u,...c.map(d=>d.cell)],eliminations:c,placements:[],houses:[r[0],r[1],a+9,l+9],candidateSnapshots:new Map(c.map(d=>[d.cell,t[d.cell].candidates]))}}}return null}const me=new Map([["NakedSingle",.1],["HiddenSingle",.2],["LastDigit",.15],["NakedPair",1.2],["HiddenPair",1.3],["NakedTriple",1.6],["HiddenTriple",1.7],["NakedQuad",1.8],["HiddenQuad",1.9],["PointingPair",1.4],["ClaimingPair",1.4],["XWing",2.2],["Swordfish",2.6],["XYWing",2.8],["XYZWing",2.9],["SimpleColoring",3],["RemotePairs",3.1],["BUG",3.2],["UniqueRectangle",3.3]]);function G(){return[{name:"NakedSingle",priority:1,detect:le,enabled:!0},{name:"HiddenSingle",priority:2,detect:ae,enabled:!0},{name:"LastDigit",priority:3,detect:re,enabled:!0},{name:"PointingPair",priority:10,detect:fe,enabled:!0},{name:"ClaimingPair",priority:11,detect:de,enabled:!0},{name:"NakedPair",priority:20,detect:t=>P(t,2),enabled:!0},{name:"HiddenPair",priority:21,detect:t=>E(t,2),enabled:!0},{name:"NakedTriple",priority:22,detect:t=>P(t,3),enabled:!0},{name:"HiddenTriple",priority:23,detect:t=>E(t,3),enabled:!0},{name:"NakedQuad",priority:24,detect:t=>P(t,4),enabled:!0},{name:"HiddenQuad",priority:25,detect:t=>E(t,4),enabled:!0},{name:"XWing",priority:30,detect:pe,enabled:!0}].sort((t,e)=>t.priority-e.priority)}function ye(t){return me.get(t)||1}function $(t){const e=[];let s=!0;for(;s;){s=!1;const n=Ce(t);n.length>0&&(e.push(...n),s=!0);const o=we(t);o.length>0&&(e.push(...o),s=!0)}const i=ve(t);return{changes:e,valid:i}}function Ce(t){const e=[];for(let s=0;s<81;s++)if(t[s].value===0&&A(t[s].candidates)){const i=q(t[s].candidates);N(t,{type:"place",cell:s,digit:i})&&e.push({type:"place",cell:s,digit:i})}return e}function we(t){const e=[];for(let s=0;s<27;s++)for(let i=1;i<=9;i++){const n=k(t,s,i);if(n.length===1){const o=n[0];t[o].value===0&&N(t,{type:"place",cell:o,digit:i})&&e.push({type:"place",cell:o,digit:i})}}return e}function ve(t){for(let e=0;e<27;e++){const s=m(e),i=new Set;for(const n of s){const o=t[n].value;if(o!==0){if(i.has(o))return!1;i.add(o)}}for(let n=1;n<=9;n++){const o=k(t,e,n);if(s.filter(l=>t[l].value===n).length===0&&o.length===0)return!1}}for(let e=0;e<81;e++)if(t[e].value===0&&t[e].candidates===0)return!1;return!0}function j(t,e={}){const{maxSteps:s=1e3,enabledTechniques:i}=e,n=y(t),o=[],{changes:a}=$(n);a.length>0&&o.push({kind:"Propagation",label:"Initial propagation",rationale:"Applying constraint propagation",affectedCells:a.map(f=>f.cell),eliminations:a.filter(f=>f.type==="eliminate"),placements:a.filter(f=>f.type==="place")});const l=G().filter(f=>!i||i.has(f.name));let r=0;for(;!D(n)&&r<s;){const f=Q(n,l);if(!f)break;o.push(f);const c=[...f.eliminations,...f.placements];if(!Z(n,c))break;const{changes:u}=$(n);u.length>0&&o.push({kind:"Propagation",label:"Constraint propagation",rationale:"Propagating constraints after "+f.kind,affectedCells:u.map(d=>d.cell),eliminations:u.filter(d=>d.type==="eliminate"),placements:u.filter(d=>d.type==="place")}),r++}return{solved:D(n),steps:o,finalBoard:n}}function $e(t,e){const s=y(t),{changes:i}=$(s);if(i.length>0)return{kind:"Propagation",label:"Constraint propagation",rationale:"Apply basic constraint propagation",affectedCells:i.map(o=>o.cell),eliminations:i.filter(o=>o.type==="eliminate"),placements:i.filter(o=>o.type==="place")};const n=G().filter(o=>!0);return Q(t,n)}function Q(t,e){for(const s of e)if(s.enabled){const i=s.detect(t);if(i)return i}return null}function I(t,e=!1){const s=y(t),{valid:i}=$(s);if(!i)return{unique:!1,solutionsFound:0};const n=[],o=e?1/0:2;function a(){if(D(s))return n.push(y(s)),n.length>=o;const l=Se(s);if(l===-1)return!1;const r=s[l].candidates,f=ke(s,l,r);for(const c of f){const u=y(s);s[l].value=c,s[l].candidates=0,xe(s,l,c);const{valid:d}=$(s);if(d&&a())return!0;for(let p=0;p<81;p++)s[p]={...u[p]}}return!1}return a(),{unique:n.length===1,solutionsFound:n.length,solution:n.length>0?n[0]:void 0}}function Se(t){let e=10,s=-1;for(let i=0;i<81;i++)if(t[i].value===0){const n=X(t[i].candidates);if(n===0)return-1;if(n<e&&(e=n,s=i,n===1))return s}return s}function ke(t,e,s){const i=[];for(let n=1;n<=9;n++)if(h(s,n)){let o=0;const a=Math.floor(e/9),l=e%9,r=Math.floor(a/3)*3+Math.floor(l/3);for(let u=0;u<9;u++){const d=a*9+u;d!==e&&t[d].value===0&&h(t[d].candidates,n)&&o++}for(let u=0;u<9;u++){const d=u*9+l;d!==e&&t[d].value===0&&h(t[d].candidates,n)&&o++}const f=Math.floor(r/3)*3,c=r%3*3;for(let u=0;u<3;u++)for(let d=0;d<3;d++){const p=(f+u)*9+(c+d);p!==e&&t[p].value===0&&h(t[p].candidates,n)&&o++}i.push({digit:n,constraintCount:o})}return i.sort((n,o)=>n.constraintCount-o.constraintCount),i.map(n=>n.digit)}function xe(t,e,s){const i=Math.floor(e/9),n=e%9,o=Math.floor(i/3)*3+Math.floor(n/3);for(let r=0;r<9;r++){const f=i*9+r;f!==e&&t[f].value===0&&(t[f].candidates&=~(1<<s-1))}for(let r=0;r<9;r++){const f=r*9+n;f!==e&&t[f].value===0&&(t[f].candidates&=~(1<<s-1))}const a=Math.floor(o/3)*3,l=o%3*3;for(let r=0;r<3;r++)for(let f=0;f<3;f++){const c=(a+r)*9+(l+f);c!==e&&t[c].value===0&&(t[c].candidates&=~(1<<s-1))}}function U(t){const e=I(t,!1);return e.unique&&e.solutionsFound===1}function Me(t){const e=j(t);if(!e.solved)return{score:10,bucket:"Expert",hardestTechnique:"Unsolvable",totalSteps:e.steps.length,details:{techniqueWeights:new Map,earliestHardStep:0,branchingPressure:0}};const s=new Map;let i=0,n="None",o=e.steps.length,a=0;e.steps.forEach((f,c)=>{const u=ye(f.kind);s.set(f.kind,u),u>i&&(i=u,n=f.kind,o=c),f.eliminations.length>3&&(a+=f.eliminations.length*.01)});const l=be(i,e.steps.length,o,a),r=Pe(l);return{score:l,bucket:r,hardestTechnique:n,totalSteps:e.steps.length,details:{techniqueWeights:s,earliestHardStep:o,branchingPressure:a}}}function be(t,e,s,i){return t+Math.min(e*.02,1)+Math.max(0,(20-s)*.05)+Math.min(i,.5)}function Pe(t){return t<1.5?"Easy":t<2.5?"Medium":t<3.5?"Hard":"Expert"}class Ee{constructor(e){_(this,"seed");this.seed=e??Math.floor(Math.random()*2147483647)}next(){return this.seed=this.seed*1103515245+12345&2147483647,this.seed/2147483648}nextInt(e){return Math.floor(this.next()*e)}shuffle(e){for(let s=e.length-1;s>0;s--){const i=this.nextInt(s+1);[e[s],e[i]]=[e[i],e[s]]}}choice(e){return e[this.nextInt(e.length)]}}const R={Easy:["530070000600195000098000060800060003400803001700020006060000280000419005000080079","700509001000000000150070063003904100000050000002106700310020059000000000900801007","090300001000080046800006900030040020009050100050090080004500009580060000600001070"],Medium:["000260701680070090190004500820100040004602900050003028009300074040050036703018000","100489006730000040000001295007120600500703004008034001900800000001300000640020100","020608000580009700000040000370000500600000004008000013000020000009800036000306090"],Hard:["000075400000000008080190000300001060000000034000068170204000603900000020530200000","300200000000107000706030500070009080900020004010800050009040301000702000000008006","000041000060000020002000000320600000000050807000003006000020000050000093003400000"],Expert:["000000039000001005003050800008090000000070000000003400007002400400000006000060003","800000000003600000070090200050007000000045700000100030001000068008500010090000400","000000012000000003002300400001800005060070800000009000008500000900040500470006000"]};function Y(t){const{difficulty:e,symmetry:s=!0,seed:i}=t,n=new Ee(i),o=R[e];if(o&&o.length>0){const l=n.choice(o),r=H(l);if(r)return r}for(let l=0;l<3;l++){const r=Te(n);if(!r)continue;const f=Le(r,e,s,n);if(f)return f}return H(R.Medium[0])}function Te(t){const e=O(),s=[1,2,3,4,5,6,7,8,9];t.shuffle(s);for(let n=0;n<9;n++)e[n].value=s[n],e[n].given=!1;return v(e),I(e,!1).solution||null}function Le(t,e,s,i){const n=y(t),o=Array.from({length:81},(f,c)=>c);i.shuffle(o);const l=He(e)+i.nextInt(5);let r=81;for(const f of o){if(r<=l)break;const c=s?De(f):f;if(n[f].value===0)continue;const u=y(n);if(n[f].value=0,n[f].given=!1,s&&c!==f&&n[c].value!==0&&(n[c].value=0,n[c].given=!1),v(n),!U(n)){for(let d=0;d<81;d++)n[d]={...u[d]};continue}r=n.filter(d=>d.value!==0).length}for(let f=0;f<81;f++)n[f].value!==0&&(n[f].given=!0);return n}function He(t){switch(t){case"Easy":return 36;case"Medium":return 32;case"Hard":return 28;case"Expert":return 23}}function De(t){return 80-t}function Ae(t=0){const e=new Date;e.setDate(e.getDate()+t);const s=e.getFullYear()*1e4+(e.getMonth()+1)*100+e.getDate();return Y({difficulty:"Medium",symmetry:!0,seed:s})}self.addEventListener("message",async t=>{const e=t.data,s=e.type;try{switch(s){case"hint":{const i=$e(e.board);self.postMessage({type:"hint",result:i});break}case"apply":{const i=[...e.board],n=Z(i,e.changes);n&&v(i),self.postMessage({type:"apply",result:{board:i,success:n}});break}case"solveHuman":{const i=j(e.board);self.postMessage({type:"solveHuman",result:i});break}case"solveFull":{const i=I(e.board);self.postMessage({type:"solveFull",result:i});break}case"validate":{const i=U(e.board);self.postMessage({type:"validate",result:{unique:i}});break}case"generate":{const i=Y(e.options);self.postMessage({type:"generate",result:i});break}case"generateDaily":{const i=Ae(e.offset||0);self.postMessage({type:"generateDaily",result:i});break}case"rate":{const i=Me(e.board);self.postMessage({type:"rate",result:i});break}case"parse":{const i=H(e.input);self.postMessage({type:"parse",result:i});break}case"updateCandidates":{const i=[...e.board];v(i),self.postMessage({type:"updateCandidates",result:i});break}}}catch(i){self.postMessage({type:"error",error:i instanceof Error?i.message:"Unknown error"})}});
