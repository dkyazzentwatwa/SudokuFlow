var V=Object.defineProperty;var J=(t,e,i)=>e in t?V(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var I=(t,e,i)=>J(t,typeof e!="symbol"?e+"":e,i);function v(t,e){return t*9+e}function C(t){return[Math.floor(t/9),t%9]}function K(t,e){return Math.floor(t/3)*3+Math.floor(e/3)}function T(t){const[e,i]=C(t);return K(e,i)}Array.from({length:9},(t,e)=>e);Array.from({length:9},(t,e)=>e+9);Array.from({length:9},(t,e)=>e+18);function S(t){return t<9?"row":t<18?"col":"box"}function m(t){const e=S(t),i=[];if(e==="row"){const s=t;for(let n=0;n<9;n++)i.push(v(s,n))}else if(e==="col"){const s=t-9;for(let n=0;n<9;n++)i.push(v(n,s))}else{const s=t-18,n=Math.floor(s/3)*3,o=s%3*3;for(let a=0;a<3;a++)for(let l=0;l<3;l++)i.push(v(n+a,o+l))}return i}const _=511;function R(t){return 1<<t-1}function h(t,e){return(t&R(e))!==0}function A(t,e){return t&~R(e)}function B(t){return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}function*ee(t){for(let e=1;e<=9;e++)h(t,e)&&(yield e)}function te(t){return Array.from(ee(t))}function ne(t){if(t===0)return 0;let e=1,i=1;for(;!(t&i);)i<<=1,e++;return e}function ie(t,e){return t|e}function L(t){return t!==0&&(t&t-1)===0}function W(t){return L(t)?ne(t):0}let k=null;function q(t){return k||se(),k[t]}function se(){k=new Array(81);for(let t=0;t<81;t++){const e=new Set,[i,s]=C(t),n=T(t);for(let l=0;l<9;l++)l!==s&&e.add(v(i,l));for(let l=0;l<9;l++)l!==i&&e.add(v(l,s));const o=Math.floor(n/3)*3,a=n%3*3;for(let l=0;l<3;l++)for(let r=0;r<3;r++){const d=v(o+l,a+r);d!==t&&e.add(d)}k[t]=Array.from(e)}}function X(){const t=new Array(81);for(let e=0;e<81;e++)t[e]={given:!1,value:0,candidates:_};return t}function y(t){return t.map(e=>({given:e.given,value:e.value,candidates:e.candidates}))}function oe(t){const e=t.replace(/[\s\n]/g,"");if(e.length!==81)return null;const i=X();for(let s=0;s<81;s++){const n=e[s];if(n!=="0"&&n!=="."){const o=parseInt(n,10);o>=1&&o<=9&&(i[s].given=!0,i[s].value=o,i[s].candidates=0)}}return w(i),i}function w(t){for(let e=0;e<81;e++)if(t[e].value===0){t[e].candidates=_;const i=q(e);for(const s of i)t[s].value!==0&&(t[e].candidates=A(t[e].candidates,t[s].value))}else t[e].candidates=0}function D(t,e){const i=t[e.cell];if(e.type==="place"){if(i.value!==0||!h(i.candidates,e.digit))return!1;i.value=e.digit,i.candidates=0;const s=q(e.cell);for(const n of s)t[n].value===0&&(t[n].candidates=A(t[n].candidates,e.digit));return!0}else return i.value!==0||!h(i.candidates,e.digit)?!1:(i.candidates=A(i.candidates,e.digit),!0)}function O(t,e){for(const i of e)if(!D(t,i))return!1;return!0}function le(t){for(let e=0;e<27;e++){const i=m(e),s=new Set;for(const n of i){const o=t[n].value;if(o!==0){if(s.has(o))return!1;s.add(o)}}}for(let e=0;e<81;e++)if(t[e].value===0&&t[e].candidates===0)return!1;return!0}function H(t){for(let e=0;e<81;e++)if(t[e].value===0)return!1;return le(t)}function x(t,e,i){const s=m(e),n=[];for(const o of s)t[o].value===0&&h(t[o].candidates,i)&&n.push(o);return n}function ae(t){for(let e=0;e<81;e++)if(t[e].value===0&&L(t[e].candidates)){const i=W(t[e].candidates),[s,n]=C(e);return{kind:"NakedSingle",label:`Naked Single: ${i}`,rationale:`Cell R${s+1}C${n+1} has only one candidate: ${i}`,affectedCells:[e],eliminations:[],placements:[{type:"place",cell:e,digit:i}],candidateSnapshots:new Map([[e,t[e].candidates]])}}return null}function re(t){for(let e=0;e<27;e++){const i=S(e);for(let s=1;s<=9;s++){const n=x(t,e,s);if(n.length===1){const o=n[0];if(t[o].value===0){const[a,l]=C(o);let r="";return i==="row"?r=`row ${e+1}`:i==="col"?r=`column ${e-9+1}`:r=`box ${e-18+1}`,{kind:"HiddenSingle",label:`Hidden Single: ${s} in ${r}`,rationale:`Digit ${s} can only go in R${a+1}C${l+1} within ${r}`,affectedCells:[o],eliminations:[],placements:[{type:"place",cell:o,digit:s}],houses:[e],candidateSnapshots:new Map([[o,t[o].candidates]])}}}}}return null}function ce(t){for(let e=0;e<27;e++){const i=S(e),s=m(e),n=[],o=new Set([1,2,3,4,5,6,7,8,9]);for(const a of s)t[a].value===0?n.push(a):o.delete(t[a].value);if(n.length===1&&o.size===1){const a=n[0],l=Array.from(o)[0],[r,d]=C(a);let c="";return i==="row"?c=`row ${e+1}`:i==="col"?c=`column ${e-9+1}`:c=`box ${e-18+1}`,{kind:"LastDigit",label:`Last Digit: ${l} in ${c}`,rationale:`R${r+1}C${d+1} is the last empty cell in ${c}, must be ${l}`,affectedCells:[a],eliminations:[],placements:[{type:"place",cell:a,digit:l}],houses:[e],candidateSnapshots:new Map([[a,t[a].candidates]])}}}return null}function P(t,e){for(let i=0;i<27;i++){const s=m(i),n=[];for(const a of s)t[a].value===0&&n.push({cell:a,candidates:t[a].candidates});if(n.length<=e)continue;const o=ue(t,n,e,i);if(o)return o}return null}function ue(t,e,i,s){const n=F(e,i);for(const o of n){let a=0;for(const l of o)a=ie(a,l.candidates);if(B(a)===i){const l=[],r=o.map(c=>c.cell),d=te(a);for(const{cell:c,candidates:u}of e)if(!r.includes(c))for(const f of d)h(u,f)&&l.push({type:"eliminate",cell:c,digit:f});if(l.length>0){const c=S(s);let u="";c==="row"?u=`row ${s+1}`:c==="col"?u=`column ${s-9+1}`:u=`box ${s-18+1}`;const f=["","","Pair","Triple","Quad"][i],p=r.map(g=>{const[M,b]=C(g);return`R${M+1}C${b+1}`}).join(", ");return{kind:`Naked${f}`,label:`Naked ${f} in ${u}`,rationale:`Cells ${p} contain only digits {${d.join(",")}}`,affectedCells:[...r,...l.map(g=>g.cell)],eliminations:l,placements:[],houses:[s],candidateSnapshots:new Map([...r,...l.map(g=>g.cell)].map(g=>[g,t[g].candidates]))}}}}return null}function E(t,e){for(let i=0;i<27;i++){const s=m(i),n=new Map;for(let a=1;a<=9;a++){const l=[];for(const r of s)t[r].value===0&&h(t[r].candidates,a)&&l.push(r);l.length>0&&l.length<=e&&n.set(a,l)}const o=fe(t,n,e,i);if(o)return o}return null}function fe(t,e,i,s){const n=Array.from(e.keys()),o=F(n,i);for(const a of o){const l=new Set;for(const r of a){const d=e.get(r);for(const c of d)l.add(c)}if(l.size===i){const r=[],d=Array.from(l);for(const c of d)for(let u=1;u<=9;u++)!a.includes(u)&&h(t[c].candidates,u)&&r.push({type:"eliminate",cell:c,digit:u});if(r.length>0){const c=S(s);let u="";c==="row"?u=`row ${s+1}`:c==="col"?u=`column ${s-9+1}`:u=`box ${s-18+1}`;const f=["","","Pair","Triple","Quad"][i],p=d.map(g=>{const[M,b]=C(g);return`R${M+1}C${b+1}`}).join(", ");return{kind:`Hidden${f}`,label:`Hidden ${f} in ${u}`,rationale:`Digits {${a.join(",")}} can only go in cells ${p} within ${u}`,affectedCells:d,eliminations:r,placements:[],houses:[s],candidateSnapshots:new Map(d.map(g=>[g,t[g].candidates]))}}}}return null}function F(t,e){if(e===0)return[[]];if(t.length<e)return[];const i=[];function s(n,o){if(o.length===e){i.push([...o]);return}for(let a=n;a<t.length;a++)o.push(t[a]),s(a+1,o),o.pop()}return s(0,[]),i}function de(t){for(let e=0;e<9;e++){const i=e+18,s=m(i);for(let n=1;n<=9;n++){const o=[];for(const a of s)t[a].value===0&&h(t[a].candidates,n)&&o.push(a);if(o.length===2||o.length===3){const a=o.map(c=>Math.floor(c/9)),l=o.map(c=>c%9),r=a.every(c=>c===a[0]),d=l.every(c=>c===l[0]);if(r){const c=a[0],u=[];for(let f=0;f<9;f++){const p=c*9+f;!o.includes(p)&&t[p].value===0&&h(t[p].candidates,n)&&u.push({type:"eliminate",cell:p,digit:n})}if(u.length>0)return{kind:"PointingPair",label:`Pointing ${o.length===2?"Pair":"Triple"}: ${n}`,rationale:`Digit ${n} in box ${e+1} must be in row ${c+1}`,affectedCells:[...o,...u.map(f=>f.cell)],eliminations:u,placements:[],houses:[i,c],candidateSnapshots:new Map(u.map(f=>[f.cell,t[f.cell].candidates]))}}if(d){const c=l[0],u=[];for(let f=0;f<9;f++){const p=f*9+c;!o.includes(p)&&t[p].value===0&&h(t[p].candidates,n)&&u.push({type:"eliminate",cell:p,digit:n})}if(u.length>0)return{kind:"PointingPair",label:`Pointing ${o.length===2?"Pair":"Triple"}: ${n}`,rationale:`Digit ${n} in box ${e+1} must be in column ${c+1}`,affectedCells:[...o,...u.map(f=>f.cell)],eliminations:u,placements:[],houses:[i,c+9],candidateSnapshots:new Map(u.map(f=>[f.cell,t[f.cell].candidates]))}}}}}return null}function pe(t){for(let e=0;e<9;e++){const i=m(e);for(let s=1;s<=9;s++){const n=[];for(const o of i)t[o].value===0&&h(t[o].candidates,s)&&n.push(o);if(n.length===2||n.length===3){const o=n.map(l=>T(l));if(o.every(l=>l===o[0])){const l=o[0],r=l+18,d=m(r),c=[];for(const u of d)!n.includes(u)&&t[u].value===0&&h(t[u].candidates,s)&&c.push({type:"eliminate",cell:u,digit:s});if(c.length>0)return{kind:"ClaimingPair",label:`Claiming ${n.length===2?"Pair":"Triple"}: ${s}`,rationale:`Digit ${s} in row ${e+1} must be in box ${l+1}`,affectedCells:[...n,...c.map(u=>u.cell)],eliminations:c,placements:[],houses:[e,r],candidateSnapshots:new Map(c.map(u=>[u.cell,t[u.cell].candidates]))}}}}}for(let e=0;e<9;e++){const i=m(e+9);for(let s=1;s<=9;s++){const n=[];for(const o of i)t[o].value===0&&h(t[o].candidates,s)&&n.push(o);if(n.length===2||n.length===3){const o=n.map(l=>T(l));if(o.every(l=>l===o[0])){const l=o[0],r=l+18,d=m(r),c=[];for(const u of d)!n.includes(u)&&t[u].value===0&&h(t[u].candidates,s)&&c.push({type:"eliminate",cell:u,digit:s});if(c.length>0)return{kind:"ClaimingPair",label:`Claiming ${n.length===2?"Pair":"Triple"}: ${s}`,rationale:`Digit ${s} in column ${e+1} must be in box ${l+1}`,affectedCells:[...n,...c.map(u=>u.cell)],eliminations:c,placements:[],houses:[e+9,r],candidateSnapshots:new Map(c.map(u=>[u.cell,t[u.cell].candidates]))}}}}}return null}function ge(t){for(let e=1;e<=9;e++){const i=he(t,e);if(i)return i;const s=me(t,e);if(s)return s}return null}function he(t,e){const i=new Map;for(let n=0;n<9;n++){const o=x(t,n,e);if(o.length===2){const a=o.map(l=>l%9);i.set(n,a)}}const s=Array.from(i.keys());for(let n=0;n<s.length;n++)for(let o=n+1;o<s.length;o++){const a=s[n],l=s[o],r=i.get(a),d=i.get(l);if(r[0]===d[0]&&r[1]===d[1]){const c=[],u=[a*9+r[0],a*9+r[1],l*9+r[0],l*9+r[1]];for(let f=0;f<9;f++)if(f!==a&&f!==l)for(const p of r){const g=f*9+p;t[g].value===0&&h(t[g].candidates,e)&&c.push({type:"eliminate",cell:g,digit:e})}if(c.length>0)return{kind:"XWing",label:`X-Wing: ${e} in rows ${a+1},${l+1}`,rationale:`Digit ${e} forms X-Wing pattern in rows ${a+1} and ${l+1} on columns ${r[0]+1} and ${r[1]+1}`,affectedCells:[...u,...c.map(f=>f.cell)],eliminations:c,placements:[],houses:[a,l,r[0]+9,r[1]+9],candidateSnapshots:new Map(c.map(f=>[f.cell,t[f.cell].candidates]))}}}return null}function me(t,e){const i=new Map;for(let n=0;n<9;n++){const o=x(t,n+9,e);if(o.length===2){const a=o.map(l=>Math.floor(l/9));i.set(n,a)}}const s=Array.from(i.keys());for(let n=0;n<s.length;n++)for(let o=n+1;o<s.length;o++){const a=s[n],l=s[o],r=i.get(a),d=i.get(l);if(r[0]===d[0]&&r[1]===d[1]){const c=[],u=[r[0]*9+a,r[1]*9+a,r[0]*9+l,r[1]*9+l];for(let f=0;f<9;f++)if(f!==a&&f!==l)for(const p of r){const g=p*9+f;t[g].value===0&&h(t[g].candidates,e)&&c.push({type:"eliminate",cell:g,digit:e})}if(c.length>0)return{kind:"XWing",label:`X-Wing: ${e} in columns ${a+1},${l+1}`,rationale:`Digit ${e} forms X-Wing pattern in columns ${a+1} and ${l+1} on rows ${r[0]+1} and ${r[1]+1}`,affectedCells:[...u,...c.map(f=>f.cell)],eliminations:c,placements:[],houses:[r[0],r[1],a+9,l+9],candidateSnapshots:new Map(c.map(f=>[f.cell,t[f.cell].candidates]))}}}return null}const ye=new Map([["NakedSingle",.1],["HiddenSingle",.2],["LastDigit",.15],["NakedPair",1.2],["HiddenPair",1.3],["NakedTriple",1.6],["HiddenTriple",1.7],["NakedQuad",1.8],["HiddenQuad",1.9],["PointingPair",1.4],["ClaimingPair",1.4],["XWing",2.2],["Swordfish",2.6],["XYWing",2.8],["XYZWing",2.9],["SimpleColoring",3],["RemotePairs",3.1],["BUG",3.2],["UniqueRectangle",3.3]]);function Z(){return[{name:"NakedSingle",priority:1,detect:ae,enabled:!0},{name:"HiddenSingle",priority:2,detect:re,enabled:!0},{name:"LastDigit",priority:3,detect:ce,enabled:!0},{name:"PointingPair",priority:10,detect:de,enabled:!0},{name:"ClaimingPair",priority:11,detect:pe,enabled:!0},{name:"NakedPair",priority:20,detect:t=>P(t,2),enabled:!0},{name:"HiddenPair",priority:21,detect:t=>E(t,2),enabled:!0},{name:"NakedTriple",priority:22,detect:t=>P(t,3),enabled:!0},{name:"HiddenTriple",priority:23,detect:t=>E(t,3),enabled:!0},{name:"NakedQuad",priority:24,detect:t=>P(t,4),enabled:!0},{name:"HiddenQuad",priority:25,detect:t=>E(t,4),enabled:!0},{name:"XWing",priority:30,detect:ge,enabled:!0}].sort((t,e)=>t.priority-e.priority)}function Ce(t){return ye.get(t)||1}function $(t){const e=[];let i=!0;for(;i;){i=!1;const n=ve(t);n.length>0&&(e.push(...n),i=!0);const o=we(t);o.length>0&&(e.push(...o),i=!0)}const s=$e(t);return{changes:e,valid:s}}function ve(t){const e=[];for(let i=0;i<81;i++)if(t[i].value===0&&L(t[i].candidates)){const s=W(t[i].candidates);D(t,{type:"place",cell:i,digit:s})&&e.push({type:"place",cell:i,digit:s})}return e}function we(t){const e=[];for(let i=0;i<27;i++)for(let s=1;s<=9;s++){const n=x(t,i,s);if(n.length===1){const o=n[0];t[o].value===0&&D(t,{type:"place",cell:o,digit:s})&&e.push({type:"place",cell:o,digit:s})}}return e}function $e(t){for(let e=0;e<27;e++){const i=m(e),s=new Set;for(const n of i){const o=t[n].value;if(o!==0){if(s.has(o))return!1;s.add(o)}}for(let n=1;n<=9;n++){const o=x(t,e,n);if(i.filter(l=>t[l].value===n).length===0&&o.length===0)return!1}}for(let e=0;e<81;e++)if(t[e].value===0&&t[e].candidates===0)return!1;return!0}function G(t,e={}){const{maxSteps:i=1e3,enabledTechniques:s}=e,n=y(t),o=[],{changes:a}=$(n);a.length>0&&o.push({kind:"Propagation",label:"Initial propagation",rationale:"Applying constraint propagation",affectedCells:a.map(d=>d.cell),eliminations:a.filter(d=>d.type==="eliminate"),placements:a.filter(d=>d.type==="place")});const l=Z().filter(d=>!s||s.has(d.name));let r=0;for(;!H(n)&&r<i;){const d=j(n,l);if(!d)break;o.push(d);const c=[...d.eliminations,...d.placements];if(!O(n,c))break;const{changes:u}=$(n);u.length>0&&o.push({kind:"Propagation",label:"Constraint propagation",rationale:"Propagating constraints after "+d.kind,affectedCells:u.map(f=>f.cell),eliminations:u.filter(f=>f.type==="eliminate"),placements:u.filter(f=>f.type==="place")}),r++}return{solved:H(n),steps:o,finalBoard:n}}function Se(t,e){const i=y(t),{changes:s}=$(i);if(s.length>0)return{kind:"Propagation",label:"Constraint propagation",rationale:"Apply basic constraint propagation",affectedCells:s.map(o=>o.cell),eliminations:s.filter(o=>o.type==="eliminate"),placements:s.filter(o=>o.type==="place")};const n=Z().filter(o=>!0);return j(t,n)}function j(t,e){for(const i of e)if(i.enabled){const s=i.detect(t);if(s)return s}return null}function N(t,e=!1){const i=y(t),{valid:s}=$(i);if(!s)return{unique:!1,solutionsFound:0};const n=[],o=e?1/0:2;function a(){if(H(i))return n.push(y(i)),n.length>=o;const l=xe(i);if(l===-1)return!1;const r=i[l].candidates,d=ke(i,l,r);for(const c of d){const u=y(i);i[l].value=c,i[l].candidates=0,Me(i,l,c);const{valid:f}=$(i);if(f&&a())return!0;for(let p=0;p<81;p++)i[p]={...u[p]}}return!1}return a(),{unique:n.length===1,solutionsFound:n.length,solution:n.length>0?n[0]:void 0}}function xe(t){let e=10,i=-1;for(let s=0;s<81;s++)if(t[s].value===0){const n=B(t[s].candidates);if(n===0)return-1;if(n<e&&(e=n,i=s,n===1))return i}return i}function ke(t,e,i){const s=[];for(let n=1;n<=9;n++)if(h(i,n)){let o=0;const a=Math.floor(e/9),l=e%9,r=Math.floor(a/3)*3+Math.floor(l/3);for(let u=0;u<9;u++){const f=a*9+u;f!==e&&t[f].value===0&&h(t[f].candidates,n)&&o++}for(let u=0;u<9;u++){const f=u*9+l;f!==e&&t[f].value===0&&h(t[f].candidates,n)&&o++}const d=Math.floor(r/3)*3,c=r%3*3;for(let u=0;u<3;u++)for(let f=0;f<3;f++){const p=(d+u)*9+(c+f);p!==e&&t[p].value===0&&h(t[p].candidates,n)&&o++}s.push({digit:n,constraintCount:o})}return s.sort((n,o)=>n.constraintCount-o.constraintCount),s.map(n=>n.digit)}function Me(t,e,i){const s=Math.floor(e/9),n=e%9,o=Math.floor(s/3)*3+Math.floor(n/3);for(let r=0;r<9;r++){const d=s*9+r;d!==e&&t[d].value===0&&(t[d].candidates&=~(1<<i-1))}for(let r=0;r<9;r++){const d=r*9+n;d!==e&&t[d].value===0&&(t[d].candidates&=~(1<<i-1))}const a=Math.floor(o/3)*3,l=o%3*3;for(let r=0;r<3;r++)for(let d=0;d<3;d++){const c=(a+r)*9+(l+d);c!==e&&t[c].value===0&&(t[c].candidates&=~(1<<i-1))}}function Q(t){const e=N(t,!1);return e.unique&&e.solutionsFound===1}function z(t){const e=G(t);if(!e.solved)return{score:10,bucket:"Expert",hardestTechnique:"Unsolvable",totalSteps:e.steps.length,details:{techniqueWeights:new Map,earliestHardStep:0,branchingPressure:0}};const i=new Map;let s=0,n="None",o=e.steps.length,a=0;e.steps.forEach((d,c)=>{const u=Ce(d.kind);i.set(d.kind,u),u>s&&(s=u,n=d.kind,o=c),d.eliminations.length>3&&(a+=d.eliminations.length*.01)});const l=be(s,e.steps.length,o,a),r=Pe(l);return{score:l,bucket:r,hardestTechnique:n,totalSteps:e.steps.length,details:{techniqueWeights:i,earliestHardStep:o,branchingPressure:a}}}function be(t,e,i,s){return t+Math.min(e*.02,1)+Math.max(0,(20-i)*.05)+Math.min(s,.5)}function Pe(t){return t<1.5?"Easy":t<2.5?"Medium":t<3.5?"Hard":"Expert"}function U(t,e){const i=z(t);return!(i.bucket!==e||e==="Easy"&&i.totalSteps<10||e==="Medium"&&i.totalSteps<15||e==="Hard"&&!Array.from(i.details.techniqueWeights.values()).some(n=>n>=2)||e==="Expert"&&!Array.from(i.details.techniqueWeights.values()).some(n=>n>=2.5))}class Ee{constructor(e){I(this,"seed");this.seed=e??Math.floor(Math.random()*2147483647)}next(){return this.seed=this.seed*1103515245+12345&2147483647,this.seed/2147483648}nextInt(e){return Math.floor(this.next()*e)}shuffle(e){for(let i=e.length-1;i>0;i--){const s=this.nextInt(i+1);[e[i],e[s]]=[e[s],e[i]]}}choice(e){return e[this.nextInt(e.length)]}}function Y(t){const{difficulty:e,symmetry:i=!0,seed:s}=t,n=new Ee(s);for(let o=0;o<10;o++){const a=Te(n);if(!a)continue;const l=Ae(a,e,i,n);if(l&&U(l,e))return l}return null}function Te(t){const e=X(),i=[1,2,3,4,5,6,7,8,9];t.shuffle(i);for(let n=0;n<9;n++)e[n].value=i[n],e[n].given=!1;return w(e),N(e,!1).solution||null}function Ae(t,e,i,s){const n=y(t),o=Array.from({length:81},(d,c)=>c);s.shuffle(o);const l=81-He(e);let r=0;for(const d of o){if(r>=l)break;const c=i?Le(d):d;if(n[d].value===0)continue;const u=y(n);if(n[d].value=0,n[d].given=!1,i&&c!==d&&n[c].value!==0&&(n[c].value=0,n[c].given=!1),w(n),!Q(n)){for(let f=0;f<81;f++)n[f]={...u[f]};continue}if(e!=="Easy"&&!U(n,e)){for(let f=0;f<81;f++)n[f]={...u[f]};continue}r+=i&&c!==d?2:1}for(let d=0;d<81;d++)n[d].value!==0&&(n[d].given=!0);return n}function He(t){switch(t){case"Easy":return 35;case"Medium":return 30;case"Hard":return 25;case"Expert":return 22}}function Le(t){return 80-t}function De(t=0){const e=new Date;e.setDate(e.getDate()+t);const i=e.getFullYear()*1e4+(e.getMonth()+1)*100+e.getDate();return Y({difficulty:"Medium",symmetry:!0,seed:i})}self.addEventListener("message",async t=>{const e=t.data,i=e.type;try{switch(i){case"hint":{const s=Se(e.board);self.postMessage({type:"hint",result:s});break}case"apply":{const s=[...e.board],n=O(s,e.changes);n&&w(s),self.postMessage({type:"apply",result:{board:s,success:n}});break}case"solveHuman":{const s=G(e.board);self.postMessage({type:"solveHuman",result:s});break}case"solveFull":{const s=N(e.board);self.postMessage({type:"solveFull",result:s});break}case"validate":{const s=Q(e.board);self.postMessage({type:"validate",result:{unique:s}});break}case"generate":{const s=Y(e.options);self.postMessage({type:"generate",result:s});break}case"generateDaily":{const s=De(e.offset||0);self.postMessage({type:"generateDaily",result:s});break}case"rate":{const s=z(e.board);self.postMessage({type:"rate",result:s});break}case"parse":{const s=oe(e.input);self.postMessage({type:"parse",result:s});break}case"updateCandidates":{const s=[...e.board];w(s),self.postMessage({type:"updateCandidates",result:s});break}}}catch(s){self.postMessage({type:"error",error:s instanceof Error?s.message:"Unknown error"})}});
